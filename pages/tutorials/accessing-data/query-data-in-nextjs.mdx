import { Steps } from "nextra/components"

# How to render a list in Next.js
 
In this tutorial, we will learn how to retrieve and render a list of data from ROQ in Next.js. We will use the ROQ SDK to query data from BaaS and render the data in a list.

This tutorial is about a straightforward Software as a Service (SaaS) platform for freelance workers. The platform will have two unique user roles, namely the **Business Owner** and the **Freelancer**. The **Business Owner** will be able to create projects while the "Freelancer" will have the ability to view and apply for projects. This tutorial will only cover the **Freelancer** role.

## Project setup

Before we start, make sure to follow the previous tutorial:

- [How to save data in Next.js](/tutorials/accessing-data/save-data-in-nextjs)

    The tutorial will guide you through the process of setting up a Next.js application and connecting it to ROQ BaaS.

    There are some changes to the code from the previous tutorial. These changes are necessary because we will build the app for the **Freelancer** role this time. The changes are:

    - Change the roles to `freelancer` when the user (freelancer) registers or sign-in. 
    - Change the page to redirect to the `freelancer` page for any successful login.

    The `index.tsx` page is responsible for user authentication. We will change the code to the following:

    ```tsx {6, 10} filename="src/pages/index.tsx"
    import { roqBrowserClient } from "@/lib/roq/roq-client";

    export default function Home() {

        const handleSignUp = async () => {
            await roqBrowserClient.signUp('freelancer', { postLoginRedirect: '/freelancer' });
        };

        const handleSignIn = async () => {
            await roqBrowserClient.signIn('freelancer', { postLoginRedirect: '/freelancer' });
        };

        return (
            {/* the code here is the same as before */}
        );
    }
    ```

## Basic query data concepts

There are two kinds of query data in ROQ BaaS: query data with filters and query data without filters.

### Query data with filters

In this example, we demonstrate how to retrieve and count review data from BaaS using the ROQ SDK using filtering criteria.

```tsx
const fetchProjectCount = async () =>{
    const projectCount = await roqBrowserClient.project.findManyWithCount({ orderBy: {
            created_at: 'desc'
        }
    })  
    return projectCount
}
    
fetchReviewCount().then((data) => {
    console.log(data);
});
```

The important thing to note is that the code syntax for the data operation follows a Prisma-like pattern.

```tsx
await roqBrowserClient.project.findManyWithCount()
```

The benefit of a Prisma-like pattern is easily understood due to its common format: `roqBrowserClient.[entity].[operation]`. Read more about the Prisma-like pattern [here](/development/sdk/query-syntax).

JSON:API is utilized to create REST APIs in ROQ BaaS, resulting in JSON-format response data. For instance, the data response from our earlier code in the browser console:

```json
{
    "data": [
        {
            "id": "7edd49af-4f44-4887-b80b-48e279999614",
            "name": "AI Chatbot",
            "description": "Develop a conversational AI chatbot designed to enhance customer service interactions, providing real-time responses and support.",
            "deadline": "2024-01-01T00:00:00.000Z",
            "status": "open",
            "company_id": "22d80a45-0cf6-445d-a5db-f1091c6cb5d6",
            "created_at": "2023-11-11T14:28:12.654Z",
            "updated_at": "2023-11-11T14:28:12.654Z"
        },
        {
            "id": "8de54627-9f5b-497d-a697-f974c413357d",
            "name": "Refactor User Signup",
            "description": "Modernize the user registration process by integrating a new API to streamline user experience and improve system reliability.",
            "deadline": null,
            "status": "active",
            "company_id": "22d80a45-0cf6-445d-a5db-f1091c6cb5d6",
            "created_at": "2023-11-10T21:49:52.947Z",
            "updated_at": "2023-11-10T21:49:52.947Z"
        }
    ],
    "count": 2
}
```


### Query data without filters

Fetching data without filters means retrieving all records from a particular dataset without any constraints. In the ROQ SDK, this can be done using methods that do not require any arguments that specify filtering criteria.

For example, to retrieve all review data from BaaS:

```tsx {4}
import { roqBrowserClient } from "@/lib/roq/roq-client";

const fetchReviewCount = async () => {
    const reviewCount = await roqBrowserClient.review.findManyWithCount();
    return reviewCount;
};

fetchReviewCount().then((data) => {
    console.log(data);
});
```

## Building project list page

We will build a simple project list to show all projects that have been created by the **Business Owner**. The project list will be displayed in the **Freelancer** page.

### Create a project list page

Create a new page called `freelancer.tsx` in the `pages` directory. The page will be the project list for the freelancer. 

The code below is the complete code for the page:

```tsx filename="src/pages/freelancer.tsx"
import { roqBrowserClient } from "@/lib/roq/roq-client";
import { useSession } from '@/lib/roq/roq-hooks';
import { useEffect, useState } from 'react';
import { ItemType } from '@/interface/project-data-types';
import ProjectList from './project-list';

export default function Projects() {
    const { session } = useSession();
    const [projects, setProjects] = useState<ItemType[]>([]);

    const roles = session?.user.roles || [];

    const logoutHandler = () => {
        roqBrowserClient.signOut();
    };

    useEffect(() => {
        const fetchProjectData = async () => {
            const projectData = await roqBrowserClient.project.findManyWithCount({
                orderBy: {
                    created_at: 'desc'
                }
            })
            return projectData
        }

        fetchProjectData().then((projects) => {
            setProjects(projects.data)
        })

    }, [])

    return (
        <div className="flex flex-col w-full h-screen bg-zinc-950">
            <nav className="flex justify-between items-center p-4 bg-zinc-800 shadow">
                <h1 className="text-white text-xl font-bold">Freelancer Inc.</h1>
                <div className="flex items-center gap-4">
                    <div>
                        <p className="text-gray-400 text-sm">
                            Logged in as: <span className="text-white">{session?.user.email}</span>
                        </p>
                        <p className="text-gray-400 text-sm">
                            Role: <span className="text-white">{roles[0]}</span>
                        </p>
                    </div>
                    <button onClick={logoutHandler} className="px-3 py-1 bg-indigo-500 rounded shadow text-white font-bold">
                        Log out
                    </button>
                </div>
            </nav>
            <ProjectList items={projects} />
        </div>

    );
}
```

The heart of this code is query data from BaaS using the ROQ SDK. The code below is the query data code:

```tsx
const projectData = await roqBrowserClient.project.findManyWithCount({
    orderBy: {
        created_at: 'desc'
    }
})
```

The code above will retrieve all project data from BaaS and sort the data by the `created_at` field in descending order. The data will be rendered in the `<ProjectList>` component.

### Create a project list component

Create a new component called `project-list.tsx` in the `pages` directory. This component is the `<ProjectList>` component that we used in the previous code. The component will render the list of projects that the **Business Owner** has created.

```tsx filename="src/pages/project-list.tsx"
import React from 'react';
import { ProjectListType } from '@/interface/project-data-types';

const List: React.FC<ProjectListType> = ({ items }) => {

    const handleApply = (projectId: string) => {
        // Logic to apply for the project
        console.log(`Applying for project with ID: ${projectId}`);
    };

    return (
        <div className="bg-gray-800 p-4 rounded-lg">
            {items.map((item, index) => (
                <div
                    key={index}
                    className="flex justify-between items-end bg-gray-700 text-white p-2 my-2 rounded-md shadow-md"
                >
                    <div>
                        <h3 className="text-lg font-semibold">{item.name}</h3>
                        <p>{item.description}</p>
                        <span className="text-indigo-400">{item.status}</span>
                    </div>
                    <button 
                        onClick={() => handleApply(item.id)}
                        disabled={item.status !== 'open'} // Disable the button if status is not 'open'
                        className={`px-3 py-1 rounded shadow font-bold ${
                            item.status === 'open' ? 'bg-indigo-500 text-white' : 'bg-gray-500 text-gray-300'
                        }`}
                    >
                        Apply
                    </button>
                </div>
            ))}
        </div>
    )
};

export default List;
```

### Add interface for project list

This page uses an interface to define the data type for the project list. Open the file called `project-data-types.ts` in the `src/interface` directory. Add this project list interface in the code and change the `export` type:


```tsx filename="src/interface/project-data-types.ts"

// the code here is the same as before 

interface ProjectListType {
    items: ItemType[];
}

export type { ItemType, ProjectListType, StatusMessageType, ProjectFormProps };
```

## What have we built?

If you follow this tutorial from the beginning, we will build a simple project list page for the **Freelancer** role. The page displays all projects created by the **Business Owner**.

![project list](/screenshots/project-list-freelancer.png)