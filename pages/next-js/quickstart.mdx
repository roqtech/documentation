import { Steps, Callout } from "nextra/components"

# Quickstart

Learn how to create a Next.js project using ROQ BaaS, install ROQ SDK, and query data from the ROQ BaaS.

{/*
### Configure user schema and roles

*/}
<Steps>
### Create a Next.js app

To create a new Next.js project. Run this command:

```shell
npx create-next-app@latest
```

And the follow along the installation questions:

```shell
What is your project named? roq-baas-nextjs
Would you like to use TypeScript? No / Yes
Would you like to use ESLint? No / Yes
Would you like to use Tailwind CSS? No / Yes
Would you like to use `src/` directory? No / Yes
Would you like to use App Router? (recommended) No / Yes
Would you like to customize the default import alias (@/*)? No / Yes
What import alias would you like configured? @/*
```

### Install ROQ BaaS SDK

Install the necessary ROQ BaaS SDK for our project, which is `@roq/nextjs` and `@roq/cli` packages. 

```shell
npm install @roq/nextjs --save
npm install @roq/cli --save-dev
```

### Setup `.env`

Besides SDK, we need to copy the environment file from the Console. Make sure to choose the appropriate environment for our project, copy the environment values, and save it to the `.env` file in our root Next.js project directory. 

{/*
<Callout type="info">
It's recommended to create a new environment whenever we develop new projects.
</Callout>
*/}

### Configure Next.js with ROQ Auth

To make our Next.js project seamlessly work with ROQ Authentication, we need to configure the project first. Add file `pages/api/auth/[...roqAuth].ts` and fill with this code:

```ts
import { RoqAuth } from '@roq/nextjs';
export default RoqAuth({});
```
### Generate SDK

Our Next.js project will work with ROQ BaaS specifically by using the customize generated SDK. To generate it, run the command below:

```shell
npx @roq/cli generate
```
This command generates a customizable SDK based on the Prisma BaaS schema and chosen environment. The default location for the code generated is `src/lib/roq`.

### Query data from the ROQ BaaS

For example, this is a snippet from the generated code:

```ts filename="src/lib/roq/roq-hooks.ts"
export function useBookFindManyWithCount<
  T extends Prisma.bookFindManyArgs,
  R extends { data: GetFindResult<Prisma.$bookPayload<DefaultArgs>, T>[]; count: number },
>(args?: Prisma.SelectSubset<T, Prisma.bookFindManyArgs>, options?: RequestOptions, swrOptions?: SWRRequestOptions<R>) {
  const roq = useRoqClient();
  const key = JSON.stringify(['useBookFindManyWithCount', args || {}]);
  return useSWR<R, Error>(
    key,
    async () => {
      const result = await roq.book.findManyWithCount(args, options);
      return result as R;
    },
    {
      ...swrOptions,
      fallbackData: swrOptions?.initialData ?? swrOptions?.fallbackData,
    },
  );
}
```

To use the `useBookFindManyWithCount` method in a Next.js page, we need to import this code:

```ts
import { useRoqClient, useBookFindManyWithCount } from 'lib/roq';
```

and then use it, for example:

```ts 
const { data, error, isLoading, mutate } = useBookFindManyWithCount({
	skip: params.pageNumber * params.pageSize,
    take: params.pageSize,
    orderBy: {
      created_at: 'desc',
    },
    ...queryParams,
});
```


### Start the Next.js app and see the result

To start the development server run this command:

```shell
npm run dev
```

And in the browser, go to `http://localhost:3000`. 

{/*
Check the result
*/}
</Steps>
